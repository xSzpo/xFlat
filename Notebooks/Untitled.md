```python
import boto3
import bson
```


```python
s3 = boto3.resource('s3')
client = boto3.client('s3')
```


```python
bucket = s3.Bucket('31b179a9-539e-4d1d-9686-3136fe76b662')
```


```python
prefix = 'offers_bson_new/'
list_files_in_offers_list = [i.key[len(prefix):] for i in bucket.objects.filter(Prefix=prefix)]

```


```python
list_files_in_offers_list
```




    ['54618936_745000.bson',
     '58207808_850000.bson',
     '59283120_749000.bson',
     '59309574_1100000.bson',
     '59393625_280000.bson',
     '59408521_829000.bson',
     '59463418_442224.bson',
     '59487324_965000.bson',
     '59492708_594150.bson',
     '59508522_1869300.bson',
     '59525507_599000.bson',
     '59528873_375000.bson',
     '59545321_750000.bson',
     '59571913_1020000.bson',
     '59573344_650000.bson',
     '59593671_498000.bson',
     '59598305_525000.bson',
     '59598400_790000.bson',
     '59618394_549000.bson',
     '59622195_539032.bson',
     '59622209_650000.bson',
     '59622217_340648.bson',
     '59622218_305000.bson',
     '59622235_975000.bson',
     '59622240_387365.bson',
     '59622266_409000.bson',
     '59622276_391347.bson']




```python
file = client.get_object(Bucket='31b179a9-539e-4d1d-9686-3136fe76b662', Key=prefix+list_files_in_offers_list[0])['Body']
```


```python
def read_bson(file_path_):
    with open(file_path_,'r') as f:
        d=bson.BSON.decode(loads(f.read()))
    return d
```


```python
d=bson.BSON.decode(loads(file.read()))
```


    ---------------------------------------------------------------------------

    NameError                                 Traceback (most recent call last)

    <ipython-input-17-acb5eabbc2a6> in <module>()
    ----> 1 d=bson.BSON.decode(loads(file.read()))
    

    NameError: name 'loads' is not defined



```python

```




    b'{"$binary": "6RkAAApmbGF0X3NpemUAAmdhbGxlcnkAYBMAAFt7InBob3RvIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJbVoxTWpjeE5HZ3liMloyYVRJdFFWQk1JaXdpZHlJNlczc2labTRpT2lKcU1Xb3piekV6YlRaaVoyNHhMVUZRVENJc0luTWlPaUl4TkNJc0luQWlPaUl4TUN3dE1UQWlMQ0poSWpvaU1DSjlYWDAuT1ZSWWdMUG5jcjRpZzI1anZ6WjBiandsU090QjZwRDlmWHF6aVpSYU9Jd1wvaW1hZ2U7cz02NTV4NDkxO3E9ODAiLCJ0aHVtYiI6Imh0dHBzOlwvXC9hcG9sbG8taXJlbGFuZC5ha2FtYWl6ZWQubmV0XC92MVwvZmlsZXNcL2V5Sm1iaUk2SW1aMU1qY3hOR2d5YjJaMmFUSXRRVkJNSWl3aWR5STZXM3NpWm00aU9pSnFNV296YnpFemJUWmlaMjR4TFVGUVRDSXNJbk1pT2lJeE5DSXNJbkFpT2lJeE1Dd3RNVEFpTENKaElqb2lNQ0o5WFgwLk9WUllnTFBuY3I0aWcyNWp2elowYmp3bFNPdEI2cEQ5ZlhxemlaUmFPSXdcL2ltYWdlO3M9MTg0eDEzODtxPTgwIn0seyJwaG90byI6Imh0dHBzOlwvXC9hcG9sbG8taXJlbGFuZC5ha2FtYWl6ZWQubmV0XC92MVwvZmlsZXNcL2V5Sm1iaUk2SW1aNmVtRjNNR0kxYW5ObVpETXRRVkJNSWl3aWR5STZXM3NpWm00aU9pSnFNV296YnpFemJUWmlaMjR4TFVGUVRDSXNJbk1pT2lJeE5DSXNJbkFpT2lJeE1Dd3RNVEFpTENKaElqb2lNQ0o5WFgwLlUxUXpuMlBQYTdObnM1Yi0xNW1kQmhvSU8yYmVvczh5ZEtfMXFHRmh4UUlcL2ltYWdlO3M9NjU1eDQ5MTtxPTgwIiwidGh1bWIiOiJodHRwczpcL1wvYXBvbGxvLWlyZWxhbmQuYWthbWFpemVkLm5ldFwvdjFcL2ZpbGVzXC9leUptYmlJNkltWjZlbUYzTUdJMWFuTm1aRE10UVZCTUlpd2lkeUk2VzNzaVptNGlPaUpxTVdvemJ6RXpiVFppWjI0eExVRlFUQ0lzSW5NaU9pSXhOQ0lzSW5BaU9pSXhNQ3d0TVRBaUxDSmhJam9pTUNKOVhYMC5VMVF6bjJQUGE3Tm5zNWItMTVtZEJob0lPMmJlb3M4eWRLXzFxR0ZoeFFJXC9pbWFnZTtzPTE4NHgxMzg7cT04MCJ9LHsicGhvdG8iOiJodHRwczpcL1wvYXBvbGxvLWlyZWxhbmQuYWthbWFpemVkLm5ldFwvdjFcL2ZpbGVzXC9leUptYmlJNkluUjBlVEowYkhZeE4yZHZiek10UVZCTUlpd2lkeUk2VzNzaVptNGlPaUpxTVdvemJ6RXpiVFppWjI0eExVRlFUQ0lzSW5NaU9pSXhOQ0lzSW5BaU9pSXhNQ3d0TVRBaUxDSmhJam9pTUNKOVhYMC5iLWdpaFZ6MjI2WkFaSFVsalJMVXVmVDd6eThoRVpqYnFzRWNtSHFLaENBXC9pbWFnZTtzPTY1NXg0OTE7cT04MCIsInRodW1iIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJblIwZVRKMGJIWXhOMmR2YnpNdFFWQk1JaXdpZHlJNlczc2labTRpT2lKcU1Xb3piekV6YlRaaVoyNHhMVUZRVENJc0luTWlPaUl4TkNJc0luQWlPaUl4TUN3dE1UQWlMQ0poSWpvaU1DSjlYWDAuYi1naWhWejIyNlpBWkhVbGpSTFV1ZlQ3enk4aEVaamJxc0VjbUhxS2hDQVwvaW1hZ2U7cz0xODR4MTM4O3E9ODAifSx7InBob3RvIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJakF3TW5wMGJHaGpNMmhrWkRNdFFWQk1JaXdpZHlJNlczc2labTRpT2lKcU1Xb3piekV6YlRaaVoyNHhMVUZRVENJc0luTWlPaUl4TkNJc0luQWlPaUl4TUN3dE1UQWlMQ0poSWpvaU1DSjlYWDAubGxJUl9WNm5YSko0OHpVU1ZMOEpPZ05Bb1dzVEZoSVNqd0RNc3MtNzVZZ1wvaW1hZ2U7cz02NTV4NDkxO3E9ODAiLCJ0aHVtYiI6Imh0dHBzOlwvXC9hcG9sbG8taXJlbGFuZC5ha2FtYWl6ZWQubmV0XC92MVwvZmlsZXNcL2V5Sm1iaUk2SWpBd01ucDBiR2hqTTJoa1pETXRRVkJNSWl3aWR5STZXM3NpWm00aU9pSnFNV296YnpFemJUWmlaMjR4TFVGUVRDSXNJbk1pT2lJeE5DSXNJbkFpT2lJeE1Dd3RNVEFpTENKaElqb2lNQ0o5WFgwLmxsSVJfVjZuWEpKNDh6VVNWTDhKT2dOQW9Xc1RGaElTandETXNzLTc1WWdcL2ltYWdlO3M9MTg0eDEzODtxPTgwIn0seyJwaG90byI6Imh0dHBzOlwvXC9hcG9sbG8taXJlbGFuZC5ha2FtYWl6ZWQubmV0XC92MVwvZmlsZXNcL2V5Sm1iaUk2SW5Fek9IaDZhSFE1WnpJeWNUSXRRVkJNSWl3aWR5STZXM3NpWm00aU9pSnFNV296YnpFemJUWmlaMjR4TFVGUVRDSXNJbk1pT2lJeE5DSXNJbkFpT2lJeE1Dd3RNVEFpTENKaElqb2lNQ0o5WFgwLlZ3eWZGOHlIYnhLS3R6MGU3N3lhVnhEVnYyX282MnRMREZxYkJWTGZDdjRcL2ltYWdlO3M9NjU1eDQ5MTtxPTgwIiwidGh1bWIiOiJodHRwczpcL1wvYXBvbGxvLWlyZWxhbmQuYWthbWFpemVkLm5ldFwvdjFcL2ZpbGVzXC9leUptYmlJNkluRXpPSGg2YUhRNVp6SXljVEl0UVZCTUlpd2lkeUk2VzNzaVptNGlPaUpxTVdvemJ6RXpiVFppWjI0eExVRlFUQ0lzSW5NaU9pSXhOQ0lzSW5BaU9pSXhNQ3d0TVRBaUxDSmhJam9pTUNKOVhYMC5Wd3lmRjh5SGJ4S0t0ejBlNzd5YVZ4RFZ2Ml9vNjJ0TERGcWJCVkxmQ3Y0XC9pbWFnZTtzPTE4NHgxMzg7cT04MCJ9LHsicGhvdG8iOiJodHRwczpcL1wvYXBvbGxvLWlyZWxhbmQuYWthbWFpemVkLm5ldFwvdjFcL2ZpbGVzXC9leUptYmlJNklqRm9jMmg1ZEdkM1kzRXpiekV0UVZCTUlpd2lkeUk2VzNzaVptNGlPaUpxTVdvemJ6RXpiVFppWjI0eExVRlFUQ0lzSW5NaU9pSXhOQ0lzSW5BaU9pSXhNQ3d0TVRBaUxDSmhJam9pTUNKOVhYMC5nQ3ppRmRRa1U1OEZWaUZYdFNjbHFXZnk5TE5tNHlmNmIyVWpmRXFDUGNZXC9pbWFnZTtzPTY1NXg0OTE7cT04MCIsInRodW1iIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJakZvYzJoNWRHZDNZM0V6YnpFdFFWQk1JaXdpZHlJNlczc2labTRpT2lKcU1Xb3piekV6YlRaaVoyNHhMVUZRVENJc0luTWlPaUl4TkNJc0luQWlPaUl4TUN3dE1UQWlMQ0poSWpvaU1DSjlYWDAuZ0N6aUZkUWtVNThGVmlGWHRTY2xxV2Z5OUxObTR5ZjZiMlVqZkVxQ1BjWVwvaW1hZ2U7cz0xODR4MTM4O3E9ODAifSx7InBob3RvIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJblIxZG5kMk5uaGlZVzFqWmkxQlVFd2lMQ0ozSWpwYmV5Sm1iaUk2SW1veGFqTnZNVE50Tm1KbmJqRXRRVkJNSWl3aWN5STZJakUwSWl3aWNDSTZJakV3TEMweE1DSXNJbUVpT2lJd0luMWRmUS5uS0R5c0R2dFNZbEpJaWtQNzBKOWVlWFdyU2NjUjdWN01SeXNqb1VtVVRJXC9pbWFnZTtzPTY1NXg0OTE7cT04MCIsInRodW1iIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJblIxZG5kMk5uaGlZVzFqWmkxQlVFd2lMQ0ozSWpwYmV5Sm1iaUk2SW1veGFqTnZNVE50Tm1KbmJqRXRRVkJNSWl3aWN5STZJakUwSWl3aWNDSTZJakV3TEMweE1DSXNJbUVpT2lJd0luMWRmUS5uS0R5c0R2dFNZbEpJaWtQNzBKOWVlWFdyU2NjUjdWN01SeXNqb1VtVVRJXC9pbWFnZTtzPTE4NHgxMzg7cT04MCJ9LHsicGhvdG8iOiJodHRwczpcL1wvYXBvbGxvLWlyZWxhbmQuYWthbWFpemVkLm5ldFwvdjFcL2ZpbGVzXC9leUptYmlJNkltWmpZakpuTkdGbk5XNXhaVE10UVZCTUlpd2lkeUk2VzNzaVptNGlPaUpxTVdvemJ6RXpiVFppWjI0eExVRlFUQ0lzSW5NaU9pSXhOQ0lzSW5BaU9pSXhNQ3d0TVRBaUxDSmhJam9pTUNKOVhYMC5hV0NMcE5YeHZXNXl1RnJNdGRRX2N0dl8tX3NPZjR0c05tUGFBanBzZVR3XC9pbWFnZTtzPTY1NXg0OTE7cT04MCIsInRodW1iIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJbVpqWWpKbk5HRm5OVzV4WlRNdFFWQk1JaXdpZHlJNlczc2labTRpT2lKcU1Xb3piekV6YlRaaVoyNHhMVUZRVENJc0luTWlPaUl4TkNJc0luQWlPaUl4TUN3dE1UQWlMQ0poSWpvaU1DSjlYWDAuYVdDTHBOWHh2VzV5dUZyTXRkUV9jdHZfLV9zT2Y0dHNObVBhQWpwc2VUd1wvaW1hZ2U7cz0xODR4MTM4O3E9ODAifSx7InBob3RvIjoiaHR0cHM6XC9cL2Fwb2xsby1pcmVsYW5kLmFrYW1haXplZC5uZXRcL3YxXC9maWxlc1wvZXlKbWJpSTZJbWh3TURsbVpUZDVZMjk0ZWpFdFFWQk1JaXdpZHlJNlczc2labTRpT2lKcU1Xb3piekV6YlRaaVoyNHhMVUZRVENJc0luTWlPaUl4TkNJc0luQWlPaUl4TUN3dE1UQWlMQ0poSWpvaU1DSjlYWDAuSzhqUDhTX3Rpb0dZOHRKM2p0bzlBZmNLMURfX0pMUEdvR3Vtd2NNTXB4Z1wvaW1hZ2U7cz02NTV4NDkxO3E9ODAiLCJ0aHVtYiI6Imh0dHBzOlwvXC9hcG9sbG8taXJlbGFuZC5ha2FtYWl6ZWQubmV0XC92MVwvZmlsZXNcL2V5Sm1iaUk2SW1od01EbG1aVGQ1WTI5NGVqRXRRVkJNSWl3aWR5STZXM3NpWm00aU9pSnFNV296YnpFemJUWmlaMjR4TFVGUVRDSXNJbk1pT2lJeE5DSXNJbkFpT2lJeE1Dd3RNVEFpTENKaElqb2lNQ0o5WFgwLks4alA4U190aW9HWTh0SjNqdG85QWZjSzFEX19KTFBHb0d1bXdjTU1weGdcL2ltYWdlO3M9MTg0eDEzODtxPTgwIn0seyJwaG90byI6Imh0dHBzOlwvXC9hcG9sbG8taXJlbGFuZC5ha2FtYWl6ZWQubmV0XC92MVwvZmlsZXNcL2V5Sm1iaUk2SW1ab2QyTnlZM3AyTXpBeGNUTXRRVkJNSWl3aWR5STZXM3NpWm00aU9pSnFNV296YnpFemJUWmlaMjR4TFVGUVRDSXNJbk1pT2lJeE5DSXNJbkFpT2lJeE1Dd3RNVEFpTENKaElqb2lNQ0o5WFgwLi1TRTJRZVdsNGZhUHJXQlBlR3hrN0pmQkVIWnlBQ21kcW1CM1gzbGMxc1FcL2ltYWdlO3M9NjU1eDQ5MTtxPTgwIiwidGh1bWIiOiJodHRwczpcL1wvYXBvbGxvLWlyZWxhbmQuYWthbWFpemVkLm5ldFwvdjFcL2ZpbGVzXC9leUptYmlJNkltWm9kMk55WTNwMk16QXhjVE10UVZCTUlpd2lkeUk2VzNzaVptNGlPaUpxTVdvemJ6RXpiVFppWjI0eExVRlFUQ0lzSW5NaU9pSXhOQ0lzSW5BaU9pSXhNQ3d0TVRBaUxDSmhJam9pTUNKOVhYMC4tU0UyUWVXbDRmYVByV0JQZUd4azdKZkJFSFp5QUNtZHFtQjNYM2xjMXNRXC9pbWFnZTtzPTE4NHgxMzg7cT04MCJ9XQACaW1nX2NvdmVyX3RpdGxlAFwAAABNaWVzemthbmllIG5hIHNwcnplZGHFvCBvIHBvd2llcnpjaG5pIDYyLDE4IG3CsiAtIFdhcnN6YXdhLCBNb2tvdMOzdywgU8WCdcW8ZXcgLSB6ZGrEmWNpZSAxAAJpc3N1ZWRfYnkAYQAAAAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9mZXJ0YSBwcnl3YXRuYSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAAKbG9jYXRpb24AAm9mZmVyX2lkAAYAAAAzSGFTQQACb2ZmZXJfdGl0bGUALAAAAEFwYXJ0YW1lbnQgcHJ6eSBNZXRyemUgU8WCdcW8ZXcgdWwuIE1vemFydGEACnByaWNlAAJwcmljZV9wZXJfc3F1YXJlAA8AAAAxMSA5ODEgesWCL23CsgAKcm9vbXMAAnRyYWNraW5nX2lkAAEAAAAAAnR5cGUAEQAAAGxpc3Rpbmdfbm9fcHJvbW8AAnVybABeAAAAaHR0cHM6Ly93d3cub3RvZG9tLnBsL29mZXJ0YS9hcGFydGFtZW50LXByenktbWV0cnplLXNsdXpldy11bC1tb3phcnRhLUlEM0hhU0EuaHRtbCNjODk3NjBiYWFlAAJ1cmxfb2ZmZXJfbGlzdAA0AAAAaHR0cHM6Ly93d3cub3RvZG9tLnBsL3NwcnplZGF6L21pZXN6a2FuaWUvd2Fyc3phd2EvAAJwcm9kdWNlcl9uYW1lAAcAAABvdG9kb20AAm1haW5fdXJsAAoAAABvdG9kb20ucGwACm9mZmVyX3R5cGUACm5hbWUACnByaWNlX20yAAptYXJrZXQACmJ1aWxkaW5nX3R5cGUACmZsb29yAApudW1iZXJfb2ZfZmxvb3JzAApidWlsZGluZ19tYXRlcmlhbAAKd2lkb3dzX3R5cGUACmhlYXRpbmdfdHlwZQAKeWVhcl9vZl9idWlsZGluZwAKZmluaXNoaW5nX3N0YWdlAApyZW50X3ByaWNlAApwcm9wZXJ0eV9mb3JtAAphdmFpbGFibGVfZnJvbQAKZGVzY3JpcHRpb24ACmFkZGl0aW9uYWxfaW5mbwACYWdlbmN5X3RyYWNraW5nX2lkAAEAAAAAAmFkZF9yZWxfZGF0ZQABAAAAAAJ1cGRhdGVfcmVsX2RhdGUAAQAAAAAQZG93bmxvYWRfZGF0ZQB0q2JdA2dlb19jb29yZGluYXRlcwBhAAAAAkB0eXBlAA8AAABHZW9Db29yZGluYXRlcwACbGF0aXR1ZGUAEgAAADUyLjE3MjM3MjkxNjU4Nzc2AAJsb25naXR1ZGUAEwAAADIxLjAzMDk2MzE5MDUzNTM4OAAAA2dlb19hZGRyZXNzX3RleHQA9gAAAAJob3VzZV9udW1iZXIAAgAAADMAAnJvYWQAHAAAAFdvbGZnYW5nYSBBbWFkZXVzemEgTW96YXJ0YQACbmVpZ2hib3VyaG9vZAAWAAAAU8WCdcW8ZXcgbmFkIERvbGlua8SFAAJzdWJ1cmIACQAAAE1va290w7N3AAJjaXR5AAkAAABXYXJzemF3YQACY291bnR5AAkAAABXYXJzemF3YQACc3RhdGUADAAAAG1hem93aWVja2llAAJwb3N0Y29kZQAHAAAAMDItNzM2AAJjb3VudHJ5AAMAAABSUAACY291bnRyeV9jb2RlAAMAAABwbAAAA2dlb19hZGRyZXNzX2Nvb3JkaW4AJQEAAAJAcGxhY2VfaWQACgAAADExODQ2NTU4MwACQG9zbV90eXBlAAQAAAB3YXkAAkBvc21faWQACgAAADE4MjIyNTYxNQACQGxhdAAMAAAANTIuMTcyNjMxMDUAAkBsb24AEQAAADIxLjAzMDYzMDA0ODY5MTIAAkBib3VuZGluZ2JveAAsAAAANTIuMTcyMjAyNSw1Mi4xNzMyNDI5LDIxLjAyOTk1NjYsMjEuMDMwOTUzNAACI3RleHQAYwAAADMsIFdvbGZnYW5nYSBBbWFkZXVzemEgTW96YXJ0YSwgU8WCdcW8ZXcgbmFkIERvbGlua8SFLCBNb2tvdMOzdywgV2Fyc3phd2EsIG1hem93aWVja2llLCAwMi03MzYsIFJQAAAA", "$type": "00"}'




```python

```
